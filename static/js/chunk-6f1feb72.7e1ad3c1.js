(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f1feb72"],{"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},"5d73":function(t,e,a){t.exports=a("469f")},"5df3":function(t,e,a){"use strict";var s=a("02f4")(!0);a("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=s(e,a),this._i+=t.length,{value:t,done:!1})}))},"768b":function(t,e,a){"use strict";var s=a("a745"),r=a.n(s);function n(t){if(r()(t))return t}var i=a("5d73"),u=a.n(i),l=a("c8bb"),o=a.n(l);function c(t,e){if(o()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],s=!0,r=!1,n=void 0;try{for(var i,l=u()(t);!(s=(i=l.next()).done);s=!0)if(a.push(i.value),e&&a.length===e)break}catch(c){r=!0,n=c}finally{try{s||null==l["return"]||l["return"]()}finally{if(r)throw n}}return a}}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(t,e){return n(t)||c(t,e)||f()}a.d(e,"a",(function(){return d}))},"7d7b":function(t,e,a){var s=a("e4ae"),r=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return s(e.call(t))}},d183:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"SPU 名称"}},[a("span",[t._v(t._s(t.spu.spuName))])]),t._v(" "),a("el-form-item",{attrs:{label:"SKU 名称"}},[a("el-input",{attrs:{type:"text",placeholder:"SKU 名称"},model:{value:t.skuInfo.skuName,callback:function(e){t.$set(t.skuInfo,"skuName",e)},expression:"skuInfo.skuName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 价格"},model:{value:t.skuInfo.price,callback:function(e){t.$set(t.skuInfo,"price",e)},expression:"skuInfo.price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"重量(千克)"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 重量"},model:{value:t.skuInfo.weight,callback:function(e){t.$set(t.skuInfo,"weight",e)},expression:"skuInfo.weight"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规格描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"SKU 规格描述",rows:"4"},model:{value:t.skuInfo.skuDesc,callback:function(e){t.$set(t.skuInfo,"skuDesc",e)},expression:"skuInfo.skuDesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"平台属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.attrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px"},attrs:{label:e.attrName}},[a("el-select",{model:{value:e.attrIdValueId,callback:function(a){t.$set(e,"attrIdValueId",a)},expression:"attr.attrIdValueId"}},t._l(e.attrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.valueName,value:e.id+":"+t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.spuSaleAttrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px"},attrs:{label:e.saleAttrName}},[a("el-select",{model:{value:e.saleAttrValueId,callback:function(a){t.$set(e,"saleAttrValueId",a)},expression:"attr.saleAttrValueId"}},t._l(e.spuSaleAttrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.saleAttrValueName,value:t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"图片列表"}},[a("el-table",{attrs:{border:"",data:t.spuImageList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.imgUrl,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"imgName"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;e.$index;return["1"===s.isDefault?a("el-tag",{attrs:{type:"success"}},[t._v("默认")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.setDefaultImg(s)}}},[t._v("设为默认")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.back}},[t._v("返回")])],1)],1)},r=[],n=a("db72"),i=(a("5df3"),a("ac6a"),a("28a5"),a("768b")),u=(a("96cf"),a("3b8d")),l={name:"SkuForm",props:{saveSuccess:Function},data:function(){return{spu:{},skuInfo:{category3Id:null,spuId:null,tmId:null,skuName:null,skuDesc:"",price:null,weight:null,skuDefaultImg:"",skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},attrList:[],spuSaleAttrList:[],spuImageList:[],selectedSpuImageList:[]}},methods:{save:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,a,s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.skuInfo,a=this.attrList,s=this.spuSaleAttrList,r=this.selectedSpuImageList,e.skuAttrValueList=a.reduce((function(t,e){if(e.attrIdValueId){var a=e.attrIdValueId.split(":"),s=Object(i["a"])(a,2),r=s[0],n=s[1];t.push({attrId:r,valueId:n})}return t}),[]),e.skuSaleAttrValueList=s.reduce((function(t,e){return e.saleAttrValueId&&t.push({saleAttrValueId:e.saleAttrValueId}),t}),[]),e.skuImageList=r.map((function(t){return{imgName:t.imgName,imgUrl:t.imgUrl,spuImgId:t.id,isDefault:t.isDefault}})),t.next=6,this.$API.sku.addUpdate(e);case 6:n=t.sent,200===n.code?(this.$message.success("保存SKU成功"),this.resetData(),this.saveSuccess()):this.$message.error("保存SKU信息失败");case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setDefaultImg:function(t){this.spuImageList.forEach((function(t){return t.isDefault="0"})),t.isDefault="1",this.skuInfo.skuDefaultImg=t.imgUrl},handleSelectionChange:function(t){this.selectedSpuImageList=t},initLoadAddData:function(t){this.spu=t,this.skuInfo.category3Id=t.category3Id,this.skuInfo.spuId=t.id,this.skuInfo.tmId=t.tmId,this.getData()},getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,a,s,r,i,u,l,o,c,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.spu,a=e.category1Id,s=e.category2Id,r=e.category3Id,i=e.id,u=this.$API.attr.getList(a,s,r),l=this.$API.sku.getSpuImageList(i),o=this.$API.sku.getSpuSaleAttrList(i),t.next=6,Promise.all([u,l,o]);case 6:c=t.sent,this.attrList=c[0].data,f=c[1].data.map((function(t){return Object(n["a"])({},t,{isDefault:"0"})})),this.spuImageList=f,this.spuSaleAttrList=c[2].data;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),back:function(){this.resetData(),this.$emit("cancel")},resetData:function(){this.skuInfo={category3Id:"",spuId:"",tmId:"",skuName:"",skuDesc:"",price:"",weight:"",skuDefaultImg:"",skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},this.spu={},this.attrList=[],this.spuImageList=[],this.spuSaleAttrList=[],this.selectedImageList=[]}}},o=l,c=a("2877"),f=Object(c["a"])(o,s,r,!1,null,null,null);e["default"]=f.exports}}]);