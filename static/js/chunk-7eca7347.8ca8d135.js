(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7eca7347","chunk-6f1feb72","chunk-b24e8352"],{"0883":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSkuForm,expression:"!isShowSkuForm"}],staticStyle:{"margin-bottom":"20px"}},[a("category-selector",{ref:"cs",on:{categoryChange:t.handleCategoryChange}})],1),t._v(" "),a("el-card",[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSpuForm&&!t.isShowSkuForm,expression:"!isShowSpuForm && !isShowSkuForm"}]},[a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.category3Id},on:{click:t.showAddSpu}},[t._v("添加SPU")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.spuList,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"SPU名称",prop:"spuName"}}),t._v(" "),a("el-table-column",{attrs:{label:"SPU描述",prop:"description"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;e.$index;return[a("hint-button",{attrs:{title:"添加SKU",type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(e){return t.showSkuAdd(s)}}}),t._v(" "),a("hint-button",{attrs:{title:"修改SPU",type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.showUpdateSpu(s.id)}}}),t._v(" "),a("hint-button",{attrs:{title:"查看所有SKU",type:"info",icon:"el-icon-info",size:"mini"},on:{click:function(e){return t.showSkuList(s)}}}),t._v(" "),a("el-popconfirm",{attrs:{title:"确定删除吗?"},on:{onConfirm:function(e){return t.deleteSpu(s.id)}}},[a("hint-button",{attrs:{slot:"reference",title:"删除SPU",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"})],1)]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center","margin-top":"20px"},attrs:{background:"","current-page":t.page,"page-sizes":[3,6,9,12],"page-size":t.limit,layout:"prev, pager, next, jumper, ->, sizes, total",total:t.total},on:{"current-change":t.getSpuList,"size-change":t.handleSizeChange}})],1),t._v(" "),a("SpuForm",{ref:"spuForm",attrs:{visible:t.isShowSpuForm},on:{"update:visible":function(e){t.isShowSpuForm=e},saveSuccess:t.handleSaveSuccess,cancel:t.handleCancel}}),t._v(" "),a("SkuForm",{directives:[{name:"show",rawName:"v-show",value:t.isShowSkuForm,expression:"isShowSkuForm"}],ref:"skuForm",attrs:{saveSuccess:function(){return t.isShowSkuForm=!1}},on:{cancel:function(e){t.isShowSkuForm=!1}}})],1),t._v(" "),a("el-dialog",{attrs:{title:"收货地址",visible:t.isShowSkuList},on:{"update:visible":function(e){t.isShowSkuList=e}}},[a("el-table",{attrs:{data:t.skuList,border:""}},[a("el-table-column",{attrs:{property:"skuName",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{property:"price",label:"价格(元)"}}),t._v(" "),a("el-table-column",{attrs:{property:"weight",label:"重量(KG)"}}),t._v(" "),a("el-table-column",{attrs:{label:"默认图片"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.skuDefaultImg,alt:""}})]}}])})],1)],1)],1)},i=[],r=a("db72"),n=(a("96cf"),a("3b8d")),u=a("9ce1"),l=a("d183"),o={name:"SpuList",data:function(){return{category1Id:"",category2Id:"",category3Id:"",loading:!1,spuList:[],page:1,limit:3,total:0,isShowSpuForm:!1,isShowSkuForm:!1,isShowSkuList:!1,spu:{},skuList:[]}},mounted:function(){},watch:{isShowSpuForm:function(t){this.$refs.cs.disabled=t}},methods:{deleteSpu:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$API.spu.remove(e);case 2:a=t.sent,200===a.code?(this.$message.success("删除成功"),this.getSpuList()):this.$message.error(a.data||a.message||"删除失败");case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),showSkuList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isShowSkuList=!0,this.spu=e,t.next=4,this.$API.sku.getListBySpuId(e.id);case 4:a=t.sent,this.skuList=a.data;case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleSaveSuccess:function(){this.getSpuList(this.spuId?this.page:1),this.spuId=null},handleCancel:function(){this.spuId=null},showSkuAdd:function(t){this.isShowSkuForm=!0,t=Object(r["a"])({},t),t.category1Id=this.category1Id,t.category2Id=this.category2Id,this.$refs.skuForm.initLoadAddData(t)},showAddSpu:function(){this.isShowSpuForm=!0,this.$refs.spuForm.initLoadAddData(this.category3Id)},showUpdateSpu:function(t){this.spuId=t,this.isShowSpuForm=!0,this.$refs.spuForm.initLoadUpdateData(t)},handleCategoryChange:function(t){var e=t.categoryId,a=t.level;1===a?(this.category1Id=e,this.category2Id="",this.category3Id="",this.spuList=[],this.total=0):2===a?(this.category2Id=e,this.category3Id="",this.spuList=[],this.total=0):(this.category3Id=e,this.getSpuList())},getSpuList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,r,n,u,l=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=l.length>0&&void 0!==l[0]?l[0]:1,this.page=e,a=this.limit,s=this.category3Id,t.next=5,this.$API.spu.getList(e,a,s);case 5:i=t.sent,200===i.code&&(r=i.data,n=r.records,u=r.total,this.spuList=n,this.total=u);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSizeChange:function(t){this.limit=t,this.getSpuList(1)}},components:{SpuForm:u["default"],SkuForm:l["default"]}},c=o,p=a("2877"),d=Object(p["a"])(c,s,i,!1,null,null,null);e["default"]=d.exports},"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},"5d73":function(t,e,a){t.exports=a("469f")},"5df3":function(t,e,a){"use strict";var s=a("02f4")(!0);a("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=s(e,a),this._i+=t.length,{value:t,done:!1})}))},"768b":function(t,e,a){"use strict";var s=a("a745"),i=a.n(s);function r(t){if(i()(t))return t}var n=a("5d73"),u=a.n(n),l=a("c8bb"),o=a.n(l);function c(t,e){if(o()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],s=!0,i=!1,r=void 0;try{for(var n,l=u()(t);!(s=(n=l.next()).done);s=!0)if(a.push(n.value),e&&a.length===e)break}catch(c){i=!0,r=c}finally{try{s||null==l["return"]||l["return"]()}finally{if(i)throw r}}return a}}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(t,e){return r(t)||c(t,e)||p()}a.d(e,"a",(function(){return d}))},"7d7b":function(t,e,a){var s=a("e4ae"),i=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return s(e.call(t))}},"9ce1":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"SPU名称"}},[a("el-input",{attrs:{type:"text",placeholder:"SPU名称"},model:{value:t.spuInfo.spuName,callback:function(e){t.$set(t.spuInfo,"spuName",e)},expression:"spuInfo.spuName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{attrs:{placeholder:"请选择品牌"},model:{value:t.spuInfo.tmId,callback:function(e){t.$set(t.spuInfo,"tmId",e)},expression:"spuInfo.tmId"}},t._l(t.trademarkList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.tmName,value:t.id}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"SPU描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"SPU描述",rows:"4"},model:{value:t.spuInfo.description,callback:function(e){t.$set(t.spuInfo,"description",e)},expression:"spuInfo.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"SPU图片"}},[a("el-upload",{attrs:{multiple:"","file-list":t.spuImageList,action:"/dev-api/admin/product/fileUpload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handleSuccess}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-select",{attrs:{placeholder:t.unUsedSaleAttrList.length>0?"还有"+t.unUsedSaleAttrList.length+"个未使用":"没有啦!!!",value:""},model:{value:t.attrIdAttrName,callback:function(e){t.attrIdAttrName=e},expression:"attrIdAttrName"}},t._l(t.unUsedSaleAttrList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id+":"+t.name}})})),1),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.attrIdAttrName},on:{click:t.addSpuSaleAttr}},[t._v("添加销售属性")]),t._v(" "),a("el-table",{staticStyle:{"margin-top":"20px"},attrs:{border:"",data:t.spuInfo.spuSaleAttrList}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"属性名",prop:"saleAttrName",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{label:"属性值名称列表"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;e.$index;return[t._l(s.spuSaleAttrValueList,(function(e,i){return a("el-tag",{key:e.id,staticStyle:{"margin-right":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return s.spuSaleAttrValueList.splice(i,1)}}},[t._v("\n            "+t._s(e.saleAttrValueName)+"\n          ")])})),t._v(" "),s.edit?a("el-input",{ref:"saveTagInput",staticStyle:{width:"100px"},attrs:{placeholder:"请输入名称",size:"small"},on:{blur:function(e){return t.handleInputConfirm(s)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(s)}},model:{value:s.saleAttrValueName,callback:function(e){t.$set(s,"saleAttrValueName",e)},expression:"row.saleAttrValueName"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.showInput(s)}}},[t._v("+ 添加")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){e.row;var s=e.$index;return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.spuInfo.spuSaleAttrList.splice(s,1)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.back}},[t._v("返回")])],1)],1)},i=[],r=(a("ac6a"),a("28a5"),a("768b")),n=(a("96cf"),a("3b8d")),u=(a("7f7f"),{props:{visible:Boolean},data:function(){return{dialogImageUrl:"",dialogVisible:!1,spuId:"",spuInfo:{spuName:"",description:"",tmId:"",spuSaleAttrList:[],spuImageList:[]},spuImageList:[],trademarkList:[],saleAttrList:[],attrIdAttrName:""}},computed:{unUsedSaleAttrList:function(){var t=this;return this.saleAttrList.filter((function(e){return t.spuInfo.spuSaleAttrList.every((function(t){return t.saleAttrName!==e.name}))}))}},methods:{save:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.spuInfo,a=this.spuImageList,e.spuImageList=a.map((function(t){return{imgName:t.name,imgUrl:t.response?t.response.data:t.url}})),e.spuSaleAttrList=e.spuSaleAttrList.filter((function(t){return delete t.edit,delete t.saleAttrValueName,t.spuSaleAttrValueList.length>0})),t.next=5,this.$API.spu.addUpdate(e);case 5:s=t.sent,200===s.code?(this.$message.success("保存SPU成功"),this.resetData(),this.$emit("update:visible",!1),this.$emit("saveSuccess")):this.$message.error("保存SPU失败");case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),resetData:function(){this.dialogImageUrl="",this.dialogVisible=!1,this.spuId=null,this.spuInfo={category3Id:"",spuName:"",description:"",tmId:"",spuImageList:[],spuSaleAttrList:[]},this.spuImageList=[],this.trademarkList=[],this.saleAttrList=[],this.attrIdAttrName=""},handleInputConfirm:function(t){var e=t.saleAttrValueName,a=t.baseSaleAttrId;if(e){var s=t.spuSaleAttrValueList.some((function(t){return t.saleAttrValueName===e}));s?this.$message.warning("不能重复!"):(t.spuSaleAttrValueList.push({saleAttrValueName:e,baseSaleAttrId:a}),t.edit=!1,t.saleAttrValueName="")}else t.edit=!1},showInput:function(t){var e=this;t.hasOwnProperty("edit")?t.edit=!0:this.$set(t,"edit",!0),this.$nextTick((function(){return e.$refs.saveTagInput.focus()}))},addSpuSaleAttr:function(){var t=this.attrIdAttrName.split(":"),e=Object(r["a"])(t,2),a=e[0],s=e[1];this.spuInfo.spuSaleAttrList.push({baseSaleAttrId:a,saleAttrName:s,spuSaleAttrValueList:[]}),this.attrIdAttrName=""},initLoadAddData:function(t){this.spuInfo.category3Id=t,this.getTrademarkList(),this.getSaleAttrList()},initLoadUpdateData:function(t){this.spuId=t,this.getSpuInfo(),this.getSpuImageList(),this.getTrademarkList(),this.getSaleAttrList()},getSpuInfo:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$API.spu.get(this.spuId);case 2:e=t.sent,this.spuInfo=e.data;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getSpuImageList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$API.sku.getSpuImageList(this.spuId);case 2:e=t.sent,a=e.data,a.forEach((function(t){t.name=t.imgName,t.url=t.imgUrl})),this.spuImageList=a;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getTrademarkList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$API.trademark.getList();case 2:e=t.sent,this.trademarkList=e.data;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getSaleAttrList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$API.spu.getSaleList();case 2:e=t.sent,this.saleAttrList=e.data;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSuccess:function(t,e,a){console.log("handleSuccess",t,e,a),this.spuImageList=a},handleRemove:function(t,e){console.log("handleRemove",t,e),this.spuImageList=e},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},back:function(){this.resetData(),this.$emit("update:visible",!1),this.$emit("cancel")}}}),l=u,o=a("2877"),c=Object(o["a"])(l,s,i,!1,null,null,null);e["default"]=c.exports},d183:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"SPU 名称"}},[a("span",[t._v(t._s(t.spu.spuName))])]),t._v(" "),a("el-form-item",{attrs:{label:"SKU 名称"}},[a("el-input",{attrs:{type:"text",placeholder:"SKU 名称"},model:{value:t.skuInfo.skuName,callback:function(e){t.$set(t.skuInfo,"skuName",e)},expression:"skuInfo.skuName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 价格"},model:{value:t.skuInfo.price,callback:function(e){t.$set(t.skuInfo,"price",e)},expression:"skuInfo.price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"重量(千克)"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 重量"},model:{value:t.skuInfo.weight,callback:function(e){t.$set(t.skuInfo,"weight",e)},expression:"skuInfo.weight"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规格描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"SKU 规格描述",rows:"4"},model:{value:t.skuInfo.skuDesc,callback:function(e){t.$set(t.skuInfo,"skuDesc",e)},expression:"skuInfo.skuDesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"平台属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.attrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px"},attrs:{label:e.attrName}},[a("el-select",{model:{value:e.attrIdValueId,callback:function(a){t.$set(e,"attrIdValueId",a)},expression:"attr.attrIdValueId"}},t._l(e.attrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.valueName,value:e.id+":"+t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.spuSaleAttrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px"},attrs:{label:e.saleAttrName}},[a("el-select",{model:{value:e.saleAttrValueId,callback:function(a){t.$set(e,"saleAttrValueId",a)},expression:"attr.saleAttrValueId"}},t._l(e.spuSaleAttrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.saleAttrValueName,value:t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"图片列表"}},[a("el-table",{attrs:{border:"",data:t.spuImageList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.imgUrl,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"imgName"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;e.$index;return["1"===s.isDefault?a("el-tag",{attrs:{type:"success"}},[t._v("默认")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.setDefaultImg(s)}}},[t._v("设为默认")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.back}},[t._v("返回")])],1)],1)},i=[],r=a("db72"),n=(a("5df3"),a("ac6a"),a("28a5"),a("768b")),u=(a("96cf"),a("3b8d")),l={name:"SkuForm",props:{saveSuccess:Function},data:function(){return{spu:{},skuInfo:{category3Id:null,spuId:null,tmId:null,skuName:null,skuDesc:"",price:null,weight:null,skuDefaultImg:"",skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},attrList:[],spuSaleAttrList:[],spuImageList:[],selectedSpuImageList:[]}},methods:{save:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.skuInfo,a=this.attrList,s=this.spuSaleAttrList,i=this.selectedSpuImageList,e.skuAttrValueList=a.reduce((function(t,e){if(e.attrIdValueId){var a=e.attrIdValueId.split(":"),s=Object(n["a"])(a,2),i=s[0],r=s[1];t.push({attrId:i,valueId:r})}return t}),[]),e.skuSaleAttrValueList=s.reduce((function(t,e){return e.saleAttrValueId&&t.push({saleAttrValueId:e.saleAttrValueId}),t}),[]),e.skuImageList=i.map((function(t){return{imgName:t.imgName,imgUrl:t.imgUrl,spuImgId:t.id,isDefault:t.isDefault}})),t.next=6,this.$API.sku.addUpdate(e);case 6:r=t.sent,200===r.code?(this.$message.success("保存SKU成功"),this.resetData(),this.saveSuccess()):this.$message.error("保存SKU信息失败");case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setDefaultImg:function(t){this.spuImageList.forEach((function(t){return t.isDefault="0"})),t.isDefault="1",this.skuInfo.skuDefaultImg=t.imgUrl},handleSelectionChange:function(t){this.selectedSpuImageList=t},initLoadAddData:function(t){this.spu=t,this.skuInfo.category3Id=t.category3Id,this.skuInfo.spuId=t.id,this.skuInfo.tmId=t.tmId,this.getData()},getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,n,u,l,o,c,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.spu,a=e.category1Id,s=e.category2Id,i=e.category3Id,n=e.id,u=this.$API.attr.getList(a,s,i),l=this.$API.sku.getSpuImageList(n),o=this.$API.sku.getSpuSaleAttrList(n),t.next=6,Promise.all([u,l,o]);case 6:c=t.sent,this.attrList=c[0].data,p=c[1].data.map((function(t){return Object(r["a"])({},t,{isDefault:"0"})})),this.spuImageList=p,this.spuSaleAttrList=c[2].data;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),back:function(){this.resetData(),this.$emit("cancel")},resetData:function(){this.skuInfo={category3Id:"",spuId:"",tmId:"",skuName:"",skuDesc:"",price:"",weight:"",skuDefaultImg:"",skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},this.spu={},this.attrList=[],this.spuImageList=[],this.spuSaleAttrList=[],this.selectedImageList=[]}}},o=l,c=a("2877"),p=Object(c["a"])(o,s,i,!1,null,null,null);e["default"]=p.exports}}]);